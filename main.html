
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
<link rel="JavaScript" type="JavaScript" href="css/bootstrap.css">

<script>

function haeXML(url, haluttuFunktio) {
  console.log("got this far");
  var xmlhttp = new XMLHttpRequest();

  xmlhttp.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200){

      haluttuFunktio(this);

    }
  };
  xmlhttp.open("GET", url, true);
  xmlhttp.send(null);
}

function asetaId(arvo){
  console.log(arvo);
  haeXML(("https://www.finnkino.fi/xml/Schedule/?area=" + arvo),leffatEsiin);
}

function haeTeatterit(xmlhttp) {

    var doc = xmlhttp.responseXML;
    var teatterit = doc.getElementsByTagName("Name");
    var iidee = doc.getElementsByTagName("ID");
    var boksi = document.getElementById('scrollBox');
    document.getElementById("scrollBox").innerHTML = "";<!-- Tyhjentää tuloskentän -->

    for (var i = 1; i < teatterit.length; i++) {
      console.log("this far too");
        var teatteriTxtNode = document.createTextNode(teatterit[i].innerHTML);
        teatteriBtn = document.createElement("button");
        teatteriBtn.classList.add('teatteri', 'btn', 'btn-light', 'btn-block', 'rounded');
        teatteriBtn.value = iidee[i].innerHTML;
        teatteriBtn.onclick = function(){asetaId(this.value)};
        teatteriBtn.appendChild(teatteriTxtNode);
        boksi.appendChild(teatteriBtn);
       }

}

function leffatEsiin(xmlhttp) {
  var doc = xmlhttp.responseXML;
  var leffat = document.getElementsByClassName('leffaKortti');
  var teatterit = document.getElementsByClassName('teatteri');
  document.getElementById('pakoPainike').style.display = "inherit";
  var loota = document.getElementById("leffat");
  loota.style.display = "inherit";

  document.getElementById("leffat").innerHTML = "";

  var leffojenNimet = doc.getElementsByTagName("OriginalTitle");
  var kuvat = doc.getElementsByTagName("EventSmallImagePortrait");

    for (var i = 0; i < leffojenNimet.length; i++) {
        var leffaBoksi = document.createElement("div");
        leffaBoksi.classList.add('leffaKortti', 'media', 'border', 'bg-purply', 'rounded-more', 'p-3', 'full');
        loota.appendChild(leffaBoksi);

        var thumbNail = document.createElement("img");
        thumbNail.src=kuvat[i].innerHTML;
        thumbNail.classList.add('img-fluid');
        leffaBoksi.appendChild(thumbNail);

        var boksiContent = document.createElement('div');
        boksiContent.classList.add('media-body');
        leffaBoksi.appendChild(boksiContent);

        var uusiTitle = document.createElement("h4");
        var titleSisalto = document.createTextNode(leffojenNimet[i].innerHTML);
        uusiTitle.appendChild(titleSisalto);
        boksiContent.appendChild(uusiTitle);

       }

}

function leffatPiiloon() {
  var leffat = document.getElementsByClassName('leffaKortti');
  var teatterit = document.getElementsByClassName('teatteri');
  document.getElementById('pakoPainike').style.display = "none";

  document.getElementById("leffat").innerHTML = "";
}


</script>

  </head>

  <body style="background-color:#FAFAFA;" onload="haeXML('https://www.finnkino.fi/xml/TheatreAreas/',haeTeatterit)">

    <div class="jumbotron jumbotron-fluid" style="background-color: #4A3A5E;">
    <h1 class="display-2 text-center" style="color: white;">FinnKino MOVIETRON</h1>
    <p class="lead text-center" style="color: #EBEBEB;"><br>Tää on se yks tehtävä siihen tehtävänantoon siitä yhestä kurssista. Mikähän se oli? Oliskohan ollu "Web-sovellusten kehittäminen JavaScriptillä"? Oli miten oli. Iskin tän valmiille "pohjalle" koska en jaksanu skrätsistä alottaa uutta, joten täs tää ny on. Pitäis vielä jaksaa vääntää sivu sen näköseks et täl ois jotain asiaankuuluvaakin. Syssymmällä si. <br> Höpö.</p>
  </div>

<div class="container"> <!-- Container starts-->

<!-- lisätään tämä -->
<div class="row text-center"> <!-- tämä on haeTeatterit() funktiolle -->
  <!-- <button type="button" onclick="haeTeatterit()" class="btn btn-info btn-block rounded">HAE</button> -->
</div>

  <div class="row text-left">
    <div class="col-lg-3 mb-2">
      <div class="teatteri d-flex justify-content-center flex-wrap bg-purply pt-3 pb-2 rounded-more">
        <h5 class="pb-2"> Teatteri: </h5>
      <div id="scrollBox" class="teatteri pre-scrollable d-flex justify-content-center rounded-more bg-purply flex-wrap mb-1 p-2" style="max-height: 300px;">
      </div>
        <button id="pakoPainike" type="button" class="btn btn-light mt-1" style="display:none;" onclick="leffatPiiloon()" onclick="haeTeatterit()"> < back</button>
    </div>
  </div>

     <div id="leffat" class="col-lg-9 d-flex justify-content-center flex-wrap" style="display:none;">
   </div>
 </div>


<!-- container ends-->


<!-- Footer -->

  </body>
  <footer class="py-5 bg-dark full">
   <div class="container bg-dark full">
     <p class="m-0 text-center text-white">Copyright &copy; Your Website 2018</p>
  </div>


</html>
